<div class="section-store-wave-container" style="height: {{ section.settings.container_height }}px;">
  <canvas id="section-store-waveCanvas"></canvas>
</div>

<style>
.section-store-wave-container {
  position: relative;
  width: 100vw;
  left: 50%;
  margin-left: -50vw;
  overflow: hidden;
  height: {{ section.settings.container_height }}px;
}
canvas#section-store-waveCanvas {
  display: block;
  width: 100vw;
  height: 100%;
}
</style>

<script>
(function(){
  const canvas = document.getElementById('section-store-waveCanvas');
  const ctx = canvas.getContext('2d');

  function resizeCanvas() {
    canvas.width = window.innerWidth;
    canvas.height = canvas.parentElement.offsetHeight;
  }
  window.addEventListener('resize', resizeCanvas);
  resizeCanvas();


  const waves = [
    { color: 'rgba(0,0,0,1)', direction: 1 },
    { color: 'rgba(0,0,0,0.3)', direction: -1 },
    { color: 'rgba(0,0,0,0.2)', direction: -1 },
    { color: 'rgba(0,0,0,0.1)', direction: 1 }
  ];

  const baseSettings = {
    amplitude: {{ section.settings.wave_amplitude }},
    wavelength: {{ section.settings.wave_wavelength }},
    speed: {{ section.settings.wave_speed }}/100
  };

 
//   waves.forEach((wave) => {
//     wave.amplitude = baseSettings.amplitude * (0.5 + Math.random() * 0.5); 
//     wave.wavelength = baseSettings.wavelength * (1 + Math.random());       
//     wave.speed = baseSettings.speed * (0.3 + Math.random() * 0.2);         
//     wave.phase = Math.random() * 2 * Math.PI;                              
//   });

waves.forEach((wave) => {
  wave.amplitude = 20 + Math.random() * 20;    // gentle vertical height
  wave.wavelength = 800 + Math.random() * 200; // long horizontal curve
  wave.speed = baseSettings.speed * (0.3 + Math.random() * 0.2); 
  wave.phase = Math.random() * 2 * Math.PI;    // random start
});


  let t = 0;

  function drawWaves() {
    const width = canvas.width;
    const height = canvas.height;
    ctx.clearRect(0, 0, width, height);

    waves.forEach(wave => {
      ctx.beginPath();
      for (let x = 0; x <= width; x++) {
        const y = height / 2
          + wave.amplitude * Math.sin((x / wave.wavelength * 2 * Math.PI) + t * wave.speed * wave.direction + wave.phase);
        
        if (x === 0) ctx.moveTo(x, y);
        else ctx.lineTo(x, y);
      }
      ctx.lineTo(width, height);
      ctx.lineTo(0, height);
      ctx.closePath();
      ctx.fillStyle = wave.color;
      ctx.fill();
    });

    t += 1;
    requestAnimationFrame(drawWaves);
  }

  drawWaves();
})();
</script>

{% schema %}
{
  "name": "Section Store Waves",
  "settings": [
    {
      "type": "range",
      "id": "container_height",
      "label": "Container Height (px)",
      "min": 100,
      "max": 800,
      "step": 10,
      "default": 300
    },
    {
      "type": "range",
      "id": "wave_amplitude",
      "label": "Wave Amplitude",
      "min": 5,
      "max": 100,
      "step": 1,
      "default": 20
    },
    {
      "type": "range",
      "id": "wave_wavelength",
      "label": "Wave Length",
      "min": 100,
      "max": 1000,
      "step": 10,
      "default": 600
    },
    {
      "type": "range",
      "id": "wave_speed",
      "label": "Wave Speed",
      "min": 1,
      "max": 10,
      "step": 1,
      "default": 2
    }
  ],
  "presets": [
    {
      "name": "Section Store Waves"
    }
  ]
}
{% endschema %}
